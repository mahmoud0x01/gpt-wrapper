# ChatGPT Clone —Å XLSX –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π

–£–ø—Ä–æ—â—ë–Ω–Ω—ã–π –∞–Ω–∞–ª–æ–≥ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ ChatGPT —Å —Ç—Ä–µ–¥–∞–º–∏, —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏ –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã–º UI –Ω–∞ –æ—Å–Ω–æ–≤–µ Vercel AI SDK.

![–ì–ª–∞–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å](docs/screenshot.png)

## üöÄ –î–µ–º–æ

**Live:** [testproject-gilt-beta.vercel.app](https://testproject-gilt-beta.vercel.app)

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

### 1. –ß–∞—Ç —Å —Ç—Ä–µ–¥–∞–º–∏
- ‚úÖ –°–ø–∏—Å–æ–∫ —Ç—Ä–µ–¥–æ–≤ –≤ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç—Ä–µ–¥–∞
- ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Ç—Ä–µ–¥–∞–º–∏
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —Ç—Ä–µ–¥–æ–≤
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ –ë–î

### 2. –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å (SQLite)
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `threads` (id, title, created_at, updated_at)
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `messages` (id, thread_id, role, content, tool_calls, created_at)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

### 3. Generative UI / Tools
- ‚úÖ `getRange` ‚Äî —á—Ç–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ —è—á–µ–µ–∫ –∏–∑ XLSX
- ‚úÖ `readCell` ‚Äî —á—Ç–µ–Ω–∏–µ –æ–¥–Ω–æ–π —è—á–µ–π–∫–∏
- ‚úÖ `updateCell` ‚Äî –∑–∞–ø–∏—Å—å –≤ —è—á–µ–π–∫—É —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º
- ‚úÖ `deleteThread` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ —Ç—Ä–µ–¥–∞ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º

### 4. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–∞—Å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
- ‚úÖ UI-–∫–∞—Ä—Ç–æ—á–∫–∞ —Å –∫–Ω–æ–ø–∫–∞–º–∏ "Yes, proceed" / "No, cancel"
- ‚úÖ –î–µ–π—Å—Ç–≤–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- ‚úÖ –£—Å–ø–µ—à–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å ‚úÖ

### 5. –†–∞–±–æ—Ç–∞ —Å XLSX
- ‚úÖ –§–∞–π–ª `/public/example.xlsx` —Å sample –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ –í–∏–∑—É–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –≤ —á–∞—Ç–µ
- ‚úÖ –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –ø–æ–ª–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ–π
- ‚úÖ –í—ã–¥–µ–ª–µ–Ω–∏–µ —è—á–µ–µ–∫ –º—ã—à–∫–æ–π
- ‚úÖ **–í—Å—Ç–∞–≤–∫–∞ –º–µ–Ω—à–æ–Ω–æ–≤** ‚Äî –∫–Ω–æ–ø–∫–∞ "Insert Reference" –≤—Å—Ç–∞–≤–ª—è–µ—Ç `@Sheet1!A1:B5` –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –í–µ—Ä—Å–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|--------|------------|
| Next.js | 16.1.1 | App Router, TypeScript |
| AI SDK | 4.x | useChat, streamText, tools |
| @ai-sdk/openai | 1.x | OpenAI –ø—Ä–æ–≤–∞–π–¥–µ—Ä |
| better-sqlite3 | latest | SQLite –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è |
| xlsx | latest | –†–∞–±–æ—Ç–∞ —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ |
| Tailwind CSS | 4.x | –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è |
| zod | 3.x | –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ tools |

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
app/
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îú‚îÄ‚îÄ chat/route.ts        # –°—Ç—Ä–∏–º–∏–Ω–≥ –æ—Ç–≤–µ—Ç–æ–≤ AI + tools
‚îÇ   ‚îî‚îÄ‚îÄ threads/route.ts     # CRUD –¥–ª—è —Ç—Ä–µ–¥–æ–≤
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ chat/ChatArea.tsx    # useChat + –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ threads/ThreadList.tsx
‚îÇ   ‚îî‚îÄ‚îÄ xlsx/TableModal.tsx  # –ú–æ–¥–∞–ª–∫–∞ —Å –≤—ã–±–æ—Ä–æ–º —è—á–µ–µ–∫
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ db/index.ts          # SQLite –æ–ø–µ—Ä–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ xlsx/index.ts        # –ß—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å XLSX
‚îú‚îÄ‚îÄ types/index.ts
‚îú‚îÄ‚îÄ page.tsx
‚îî‚îÄ‚îÄ layout.tsx
public/
‚îî‚îÄ‚îÄ example.xlsx             # XLSX —Ñ–∞–π–ª —Å sample –¥–∞–Ω–Ω—ã–º–∏
data/
‚îî‚îÄ‚îÄ chat.db                  # SQLite –±–∞–∑–∞ (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
```

---

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
npm install
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenAI –∫–ª—é—á–∞
```bash
echo "OPENAI_API_KEY=–≤–∞—à-–∫–ª—é—á" > .env.local
```

### –ó–∞–ø—É—Å–∫ development —Å–µ—Ä–≤–µ—Ä–∞
```bash
npm run dev
```

–û—Ç–∫—Ä–æ–π—Ç–µ [http://localhost:3000](http://localhost:3000)

---

## üß™ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

| –§—É–Ω–∫—Ü–∏—è | –°—Ç–∞—Ç—É—Å |
|---------|--------|
| AI —Å—Ç—Ä–∏–º–∏–Ω–≥ | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| getRange (—á—Ç–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã) | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| updateCell (–∑–∞–ø–∏—Å—å) | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ Yes/No | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –≤ SQLite | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ç–∞–±–ª–∏—Ü—ã | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| –í—ã–¥–µ–ª–µ–Ω–∏–µ —è—á–µ–µ–∫ | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| Insert Reference | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**
> "–ü–æ–∫–∞–∂–∏ –¥–∞–Ω–Ω—ã–µ –∏–∑ Sheet1 —Å A1 –ø–æ D7"

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —è—á–µ–π–∫–∏:**
> "–ò–∑–º–µ–Ω–∏ —è—á–µ–π–∫—É C3 –Ω–∞ 5000"  
> *(–ø–æ—è–≤–∏—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ‚Üí –Ω–∞–∂–∞—Ç—å "Yes, proceed")*

**–í—Å—Ç–∞–≤–∫–∞ —Å—Å—ã–ª–∫–∏ –Ω–∞ —è—á–µ–π–∫–∏:**
1. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ —Ç–∞–±–ª–∏—Ü—É –≤ —á–∞—Ç–µ
2. –í—ã–¥–µ–ª–∏—Ç–µ –Ω—É–∂–Ω—ã–µ —è—á–µ–π–∫–∏ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
3. –ù–∞–∂–º–∏—Ç–µ "Insert Reference"
4. –í –ø–æ–ª–µ –≤–≤–æ–¥–∞ –ø–æ—è–≤–∏—Ç—Å—è `@Sheet1!A2:C4`

---

## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- –ù–∞ Vercel SQLite —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –¥–µ–ø–ª–æ–µ
- –û–¥–∏–Ω XLSX —Ñ–∞–π–ª (`/public/example.xlsx`)

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
